# NOTE: We launch an interactive `buildFHSEnv` (FHS container) via the flake app.
# Some `nix-direnv` setups can recurse/hang when trying to materialize buildFHSEnv
# as a "devShell". To keep this reliable, this `.envrc` acts only as a launcher.

# Avoid recursion when nested shells re-trigger direnv.
if [ "$FHS_CURRENT" != "$1" ]; then
  export FHS_CURRENT="$1"

  # Prefer a single substituter to avoid incomplete mirrors.
  export NIX_CONFIG="
substituters = https://cache.nixos.org
trusted-public-keys = cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY=
"

  exec nix run path:.#unreal-fhs
fi
